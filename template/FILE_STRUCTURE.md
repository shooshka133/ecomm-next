# Template System File Structure

## Complete File Tree

```
ecomm/
├── template/                          # Template deployment system
│   ├── config/                        # Configuration templates
│   │   ├── branding.json             # Default branding config
│   │   ├── env.example.json          # Environment variable template
│   │   └── database-config.json      # Database migration reference
│   │
│   ├── override/                      # User customizations (never overwritten)
│   │   ├── README.md                 # Override instructions
│   │   └── branding.example.json    # Example override file
│   │
│   ├── scripts/                       # Automation scripts
│   │   ├── install-template.js      # Interactive setup wizard
│   │   ├── apply-branding.js         # Apply custom branding
│   │   └── sync-env.js               # Sync env vars from JSON
│   │
│   ├── README.md                      # Complete deployment guide
│   ├── USAGE_EXAMPLES.md             # Usage examples and patterns
│   ├── DEPLOYMENT_SUMMARY.md         # What was created/modified
│   └── FILE_STRUCTURE.md             # This file
│
├── lib/
│   └── template/                      # Abstraction layer (NEW)
│       ├── branding.ts               # Branding configuration functions
│       ├── branding.json             # Runtime branding (generated)
│       └── env.ts                     # Environment variable helpers
│
├── components/
│   └── TemplateModeBanner.tsx         # Optional template mode banner (NEW)
│
└── package.json                       # Added template scripts (MODIFIED - scripts only)
```

## File Descriptions

### Configuration Files

#### `template/config/branding.json`
- **Purpose**: Default branding configuration
- **Contains**: Store name, colors, logos, meta tags
- **Used by**: `apply-branding.js` script
- **Can be overridden**: Yes, via `template/override/branding.json`

#### `template/config/env.example.json`
- **Purpose**: Template for environment variables
- **Contains**: Supabase, Stripe, Resend, App config
- **Used by**: `sync-env.js` script
- **Can be overridden**: Yes, via `template/override/env.local.json`

#### `template/config/database-config.json`
- **Purpose**: Reference for database migrations
- **Contains**: List of SQL files and required tables
- **Used by**: Documentation only
- **Can be overridden**: No

### Override Files

#### `template/override/branding.json`
- **Purpose**: User's custom branding (merges with default)
- **Created by**: User (copy from `branding.example.json`)
- **Never overwritten**: Yes, preserved during updates
- **Applied by**: `apply-branding.js` script

#### `template/override/logo.svg`, `favicon.svg`, etc.
- **Purpose**: Custom logo files
- **Created by**: User
- **Never overwritten**: Yes
- **Applied by**: `apply-branding.js` script

### Scripts

#### `template/scripts/install-template.js`
- **Purpose**: Interactive setup wizard
- **What it does**:
  - Prompts for Supabase credentials
  - Prompts for Stripe keys
  - Prompts for Resend API key
  - Creates `.env.local`
  - Provides next steps
- **Run with**: `npm run template:install`

#### `template/scripts/apply-branding.js`
- **Purpose**: Apply custom branding to project
- **What it does**:
  - Merges `template/config/branding.json` with `template/override/branding.json`
  - Copies logo files from `template/override/` to `app/`
  - Creates `lib/template/branding.json` (runtime config)
- **Run with**: `npm run template:branding`

#### `template/scripts/sync-env.js`
- **Purpose**: Sync environment variables from JSON to `.env.local`
- **What it does**:
  - Reads `template/config/env.example.json`
  - Merges with existing `.env.local` (preserves existing values)
  - Writes updated `.env.local`
- **Run with**: `npm run template:sync-env`

### Abstraction Layer

#### `lib/template/branding.ts`
- **Purpose**: Branding configuration functions
- **Exports**:
  - `getStoreBranding()` - Full branding config
  - `getStoreName()` - Store name
  - `getLogoUrl()` - Logo URL
  - `getPrimaryColor()` - Primary color
  - `getSupportEmail()` - Support email
- **Behavior**: 
  - If `NEXT_PUBLIC_TEMPLATE_MODE=true`: Uses JSON config
  - If `NEXT_PUBLIC_TEMPLATE_MODE=false`: Returns default values

#### `lib/template/env.ts`
- **Purpose**: Environment variable helpers
- **Exports**:
  - `getAppUrl()` - App URL
  - `isTemplateMode()` - Template mode flag
  - `getAdminEmails()` - Admin emails array
  - `getStoreCurrency()` - Currency code
  - `getStoreCurrencySymbol()` - Currency symbol
  - `getShippingCountries()` - Shipping countries array
  - `getResendFromName()` - Email sender name

#### `lib/template/branding.json`
- **Purpose**: Runtime branding configuration
- **Generated by**: `apply-branding.js` script
- **Contains**: Merged branding values (default + override)
- **Used by**: `branding.ts` when template mode is enabled

### Components

#### `components/TemplateModeBanner.tsx`
- **Purpose**: Optional banner for admin dashboard
- **Shows when**: `NEXT_PUBLIC_TEMPLATE_MODE=true`
- **Usage**: Import and add to admin page (optional)
- **Does not modify**: Existing admin page code

## File Relationships

```
User edits
  ↓
template/override/branding.json
  ↓
npm run template:branding
  ↓
lib/template/branding.json (generated)
  ↓
lib/template/branding.ts (reads JSON)
  ↓
Components use getStoreBranding()
```

## What Gets Committed

### ✅ Should Commit
- `template/config/` - Default templates
- `template/scripts/` - Automation scripts
- `template/override/` - Your customizations
- `lib/template/branding.ts` - Abstraction layer
- `lib/template/env.ts` - Environment helpers
- `components/TemplateModeBanner.tsx` - Optional component

### ❌ Should NOT Commit
- `.env.local` - Contains secrets (in .gitignore)
- `lib/template/branding.json` - Generated file (can be regenerated)

## File Sizes

All template files are small text files:
- JSON configs: ~1-2 KB each
- Scripts: ~3-5 KB each
- Documentation: ~10-50 KB each
- Total: ~100 KB (negligible)

## Dependencies

Template system has **zero dependencies**:
- Uses Node.js built-in modules (`fs`, `path`, `readline`)
- No npm packages required
- Works with existing project dependencies

